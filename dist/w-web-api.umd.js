/*!
 * w-web-api v1.0.31
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("path"),require("fs"),require("@hapi/hapi"),require("@hapi/inert"),require("events"),require("stream")):"function"==typeof define&&define.amd?define(["path","fs","@hapi/hapi","@hapi/inert","events","stream"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["w-web-api"]=t(e.path,e.fs,e["@hapi/hapi"],e["@hapi/inert"],e.events,e.stream)}(this,(function(e,t,n,r,o,a){"use strict";var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u=Array.isArray,c="object"==typeof i&&i&&i.Object===Object&&i,l=c,f="object"==typeof self&&self&&self.Object===Object&&self,p=l||f||Function("return this")(),d=p.Symbol,h=d,m=Object.prototype,v=m.hasOwnProperty,y=m.toString,g=h?h.toStringTag:void 0;var b=function(e){var t=v.call(e,g),n=e[g];try{e[g]=void 0;var r=!0}catch(e){}var o=y.call(e);return r&&(t?e[g]=n:delete e[g]),o},w=Object.prototype.toString;var j=b,O=function(e){return w.call(e)},S=d?d.toStringTag:void 0;var A=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":S&&S in Object(e)?j(e):O(e)};var T=function(e){return null!=e&&"object"==typeof e},I=A,E=T;var _=function(e){return"symbol"==typeof e||E(e)&&"[object Symbol]"==I(e)},k=u,B=_,N=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,C=/^\w*$/;var P=function(e,t){if(k(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!B(e))||(C.test(e)||!N.test(e)||null!=t&&e in Object(t))};var x=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},R=A,D=x;var $,G=function(e){if(!D(e))return!1;var t=R(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},U=p["__core-js_shared__"],M=($=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var L=function(e){return!!M&&M in e},F=Function.prototype.toString;var W=function(e){if(null!=e){try{return F.call(e)}catch(e){}try{return e+""}catch(e){}}return""},z=G,H=L,Y=x,q=W,J=/^\[object .+?Constructor\]$/,V=Function.prototype,Z=Object.prototype,X=V.toString,K=Z.hasOwnProperty,Q=RegExp("^"+X.call(K).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ee=function(e){return!(!Y(e)||H(e))&&(z(e)?Q:J).test(q(e))},te=function(e,t){return null==e?void 0:e[t]};var ne=function(e,t){var n=te(e,t);return ee(n)?n:void 0},re=ne(Object,"create"),oe=re;var ae=function(){this.__data__=oe?oe(null):{},this.size=0};var ie=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},se=re,ue=Object.prototype.hasOwnProperty;var ce=function(e){var t=this.__data__;if(se){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return ue.call(t,e)?t[e]:void 0},le=re,fe=Object.prototype.hasOwnProperty;var pe=re;var de=ae,he=ie,me=ce,ve=function(e){var t=this.__data__;return le?void 0!==t[e]:fe.call(t,e)},ye=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=pe&&void 0===t?"__lodash_hash_undefined__":t,this};function ge(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ge.prototype.clear=de,ge.prototype.delete=he,ge.prototype.get=me,ge.prototype.has=ve,ge.prototype.set=ye;var be=ge;var we=function(){this.__data__=[],this.size=0};var je=function(e,t){return e===t||e!=e&&t!=t},Oe=je;var Se=function(e,t){for(var n=e.length;n--;)if(Oe(e[n][0],t))return n;return-1},Ae=Se,Te=Array.prototype.splice;var Ie=Se;var Ee=Se;var _e=Se;var ke=we,Be=function(e){var t=this.__data__,n=Ae(t,e);return!(n<0)&&(n==t.length-1?t.pop():Te.call(t,n,1),--this.size,!0)},Ne=function(e){var t=this.__data__,n=Ie(t,e);return n<0?void 0:t[n][1]},Ce=function(e){return Ee(this.__data__,e)>-1},Pe=function(e,t){var n=this.__data__,r=_e(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function xe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}xe.prototype.clear=ke,xe.prototype.delete=Be,xe.prototype.get=Ne,xe.prototype.has=Ce,xe.prototype.set=Pe;var Re=xe,De=ne(p,"Map"),$e=be,Ge=Re,Ue=De;var Me=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Le=function(e,t){var n=e.__data__;return Me(t)?n["string"==typeof t?"string":"hash"]:n.map},Fe=Le;var We=Le;var ze=Le;var He=Le;var Ye=function(e,t){var n=He(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},qe=function(){this.size=0,this.__data__={hash:new $e,map:new(Ue||Ge),string:new $e}},Je=function(e){var t=Fe(this,e).delete(e);return this.size-=t?1:0,t},Ve=function(e){return We(this,e).get(e)},Ze=function(e){return ze(this,e).has(e)},Xe=Ye;function Ke(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ke.prototype.clear=qe,Ke.prototype.delete=Je,Ke.prototype.get=Ve,Ke.prototype.has=Ze,Ke.prototype.set=Xe;var Qe=Ke,et=Qe;function tt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var i=e.apply(this,r);return n.cache=a.set(o,i)||a,i};return n.cache=new(tt.Cache||et),n}tt.Cache=et;var nt=tt;var rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ot=/\\(\\)?/g,at=function(e){var t=nt(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rt,(function(e,n,r,o){t.push(r?o.replace(ot,"$1"):n||e)})),t}));var it=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},st=it,ut=u,ct=_,lt=d?d.prototype:void 0,ft=lt?lt.toString:void 0;var pt=function e(t){if("string"==typeof t)return t;if(ut(t))return st(t,e)+"";if(ct(t))return ft?ft.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n},dt=pt;var ht=function(e){return null==e?"":dt(e)},mt=u,vt=P,yt=at,gt=ht;var bt=function(e,t){return mt(e)?e:vt(e,t)?[e]:yt(gt(e))},wt=_;var jt=function(e){if("string"==typeof e||wt(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t},Ot=bt,St=jt;var At=function(e,t){for(var n=0,r=(t=Ot(t,e)).length;null!=e&&n<r;)e=e[St(t[n++])];return n&&n==r?e:void 0},Tt=At;var It=function(e,t,n){var r=null==e?void 0:Tt(e,t);return void 0===r?n:r},Et={},_t={get exports(){return Et},set exports(e){Et=e}};var kt=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e};var Bt=function(e){return function(t,n,r){for(var o=-1,a=Object(t),i=r(t),s=i.length;s--;){var u=i[e?s:++o];if(!1===n(a[u],u,a))break}return t}}();var Nt=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},Ct=A,Pt=T;var xt=function(e){return Pt(e)&&"[object Arguments]"==Ct(e)},Rt=T,Dt=Object.prototype,$t=Dt.hasOwnProperty,Gt=Dt.propertyIsEnumerable,Ut=xt(function(){return arguments}())?xt:function(e){return Rt(e)&&$t.call(e,"callee")&&!Gt.call(e,"callee")},Mt=Ut,Lt={};var Ft=function(){return!1};!function(e,t){var n=p,r=Ft,o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,i=a&&a.exports===o?n.Buffer:void 0,s=(i?i.isBuffer:void 0)||r;e.exports=s}({get exports(){return Lt},set exports(e){Lt=e}},Lt);var Wt=/^(?:0|[1-9]\d*)$/;var zt=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Wt.test(e))&&e>-1&&e%1==0&&e<t};var Ht=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Yt=A,qt=Ht,Jt=T,Vt={};Vt["[object Float32Array]"]=Vt["[object Float64Array]"]=Vt["[object Int8Array]"]=Vt["[object Int16Array]"]=Vt["[object Int32Array]"]=Vt["[object Uint8Array]"]=Vt["[object Uint8ClampedArray]"]=Vt["[object Uint16Array]"]=Vt["[object Uint32Array]"]=!0,Vt["[object Arguments]"]=Vt["[object Array]"]=Vt["[object ArrayBuffer]"]=Vt["[object Boolean]"]=Vt["[object DataView]"]=Vt["[object Date]"]=Vt["[object Error]"]=Vt["[object Function]"]=Vt["[object Map]"]=Vt["[object Number]"]=Vt["[object Object]"]=Vt["[object RegExp]"]=Vt["[object Set]"]=Vt["[object String]"]=Vt["[object WeakMap]"]=!1;var Zt=function(e){return Jt(e)&&qt(e.length)&&!!Vt[Yt(e)]};var Xt=function(e){return function(t){return e(t)}},Kt={};!function(e,t){var n=c,r=t&&!t.nodeType&&t,o=r&&e&&!e.nodeType&&e,a=o&&o.exports===r&&n.process,i=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=i}({get exports(){return Kt},set exports(e){Kt=e}},Kt);var Qt=Zt,en=Xt,tn=Kt&&Kt.isTypedArray,nn=tn?en(tn):Qt,rn=Nt,on=Mt,an=u,sn=Lt,un=zt,cn=nn,ln=Object.prototype.hasOwnProperty;var fn=function(e,t){var n=an(e),r=!n&&on(e),o=!n&&!r&&sn(e),a=!n&&!r&&!o&&cn(e),i=n||r||o||a,s=i?rn(e.length,String):[],u=s.length;for(var c in e)!t&&!ln.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||un(c,u))||s.push(c);return s},pn=Object.prototype;var dn=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||pn)};var hn=function(e,t){return function(n){return e(t(n))}},mn=hn(Object.keys,Object),vn=dn,yn=mn,gn=Object.prototype.hasOwnProperty;var bn=function(e){if(!vn(e))return yn(e);var t=[];for(var n in Object(e))gn.call(e,n)&&"constructor"!=n&&t.push(n);return t},wn=G,jn=Ht;var On=function(e){return null!=e&&jn(e.length)&&!wn(e)},Sn=fn,An=bn,Tn=On;var In=function(e){return Tn(e)?Sn(e):An(e)},En=Bt,_n=In;var kn=On;var Bn=function(e,t){return function(n,r){if(null==n)return n;if(!kn(n))return e(n,r);for(var o=n.length,a=t?o:-1,i=Object(n);(t?a--:++a<o)&&!1!==r(i[a],a,i););return n}}((function(e,t){return e&&En(e,t,_n)}));var Nn=function(e){return e},Cn=Nn;var Pn=kt,xn=Bn,Rn=function(e){return"function"==typeof e?e:Cn},Dn=u;var $n=function(e,t){return(Dn(e)?Pn:xn)(e,Rn(t))};!function(e){e.exports=$n}(_t);var Gn=s(Et);function Un(e){return"[object String]"===Object.prototype.toString.call(e)}function Mn(e){return!(!Un(e)||""===e)}function Ln(e){if(!Mn(e))return{};let t={};try{t=JSON.parse(e)}catch(e){t={}}return t}function Fn(e){return"[object Object]"===Object.prototype.toString.call(e)}function Wn(e){if(Fn(e)){for(let t in e)return!0;return!1}return!1}function zn(e){return"[object Array]"===Object.prototype.toString.call(e)}function Hn(e){return"[object Undefined]"===Object.prototype.toString.call(e)}function Yn(e){if(Fn(e)){for(let t in e)return!1;return!0}return!1}function qn(e){return e!=e}function Jn(e){return!!Hn(e)||(!!function(e){return"[object Null]"===Object.prototype.toString.call(e)}(e)||(!!Yn(e)||(!!function(e){return!(!Un(e)||""!==e)}(e)||(!!function(e){return!!zn(e)&&0===e.length}(e)||!!qn(e)))))}function Vn(e){return!!zn(e)&&(0!==e.length&&(1!==e.length||!Jn(e[0])))}var Zn=/\s/;var Xn=function(e){for(var t=e.length;t--&&Zn.test(e.charAt(t)););return t},Kn=/^\s+/;var Qn=function(e){return e?e.slice(0,Xn(e)+1).replace(Kn,""):e},er=Qn,tr=x,nr=_,rr=/^[-+]0x[0-9a-f]+$/i,or=/^0b[01]+$/i,ar=/^0o[0-7]+$/i,ir=parseInt;var sr=function(e){if("number"==typeof e)return e;if(nr(e))return NaN;if(tr(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=tr(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=er(e);var n=or.test(e);return n||ar.test(e)?ir(e.slice(2),n?2:8):rr.test(e)?NaN:+e},ur=sr,cr=1/0;var lr=function(e){return e?(e=ur(e))===cr||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},fr=lr;var pr=function(e){var t=fr(e),n=t%1;return t==t?n?t-n:t:0},dr=pr;var hr=function(e){return"number"==typeof e&&e==dr(e)};function mr(e){let t=!1;if(Mn(e))t=!isNaN(Number(e));else if(function(e){return"[object Number]"===Object.prototype.toString.call(e)}(e)){if(qn(e))return!1;t=!0}return t}function vr(e){if(!mr(e))return 0;return lr(e)}function yr(e){return!!mr(e)&&(e=vr(e),hr(e))}var gr=pr,br=sr,wr=ht,jr=p.isFinite,Or=Math.min;var Sr=function(e){var t=Math[e];return function(e,n){if(e=br(e),(n=null==n?0:Or(gr(n),292))&&jr(e)){var r=(wr(e)+"e").split("e"),o=t(r[0]+"e"+(+r[1]+n));return+((r=(wr(o)+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}("round");function Ar(e){if(!mr(e))return 0;e=vr(e);let t=Sr(e);return"0"===String(t)?0:t}function Tr(e){if(!yr(e))return!1;return Ar(e)>0}function Ir(e){let t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}function Er(e){let t,n=Object.prototype.toString.call(e);if(t="[object Promise]"===n,t)return!0;if("[object Function]"!==n)return!1;try{t="function"!=typeof e.subscribe&&"function"==typeof e.then}catch(e){}return t}function _r(e){if(!yr(e))return!1;return Ar(e)>=0}function kr(e,t){return Mn(e)&&_r(t)?0===(t=Ar(t))?"":e.substring(0,t):""}function Br(e,t){if(!Mn(e))return"";if(!_r(t))return"";if(0===(t=Ar(t)))return"";let n=e.length-t;return n<0&&(n=0),e.substr(n,t)}function Nr(){let e,t,n=new Promise((function(){e=arguments[0],t=arguments[1]}));return n.resolve=e,n.reject=t,n}let Cr=function(e){if(!Ir(e))throw new Error("fn is not a function");return function(){let t=Nr(),n=null,r=null;try{n=e.apply(this,arguments)}catch(e){r=e}return null!==r?t.resolve({state:"error",msg:r}):Er(n)?n.then((e=>{t.resolve({state:"success",msg:e})})).catch((e=>{"cancelled"===It(e,"reason")?t.resolve({state:"cancelled",msg:""}):t.resolve({state:"error",msg:e})})):t.resolve({state:"success",msg:n}),t}};var Pr={};var xr,Rr={},Dr={get exports(){return Rr},set exports(e){Rr=e}};function $r(){return xr||(xr=1,function(e,t){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==i&&i.crypto&&(n=i.crypto),!n)try{n=require("crypto")}catch(e){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),a={},s=a.lib={},u=s.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=s.WordArray=u.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||f).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var a=0;a<o;a++){var i=n[a>>>2]>>>24-a%4*8&255;t[r+a>>>2]|=i<<24-(r+a)%4*8}else for(var s=0;s<o;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new c.init(t,e)}}),l=a.enc={},f=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var a=t[o>>>2]>>>24-o%4*8&255;r.push((a>>>4).toString(16)),r.push((15&a).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new c.init(n,t/2)}},p=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var a=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new c.init(n,t)}},d=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},h=s.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,o=r.words,a=r.sigBytes,i=this.blockSize,s=a/(4*i),u=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,l=e.min(4*u,a);if(u){for(var f=0;f<u;f+=i)this._doProcessBlock(o,f);n=o.splice(0,u),r.sigBytes-=l}return new c.init(n,l)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=h.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}});var m=a.algo={};return a}(Math),n)}(Dr)),Rr}!function(e,t){e.exports=$r().enc.Utf8}({get exports(){return Pr},set exports(e){Pr=e}});var Gr=Pr,Ur={};!function(e,t){var n;e.exports=(n=$r(),function(){var e=n,t=e.lib.WordArray;function r(e,n,r){for(var o=[],a=0,i=0;i<n;i++)if(i%4){var s=r[e.charCodeAt(i-1)]<<i%4*2|r[e.charCodeAt(i)]>>>6-i%4*2;o[a>>>2]|=s<<24-a%4*8,a++}return t.create(o,a)}e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],a=0;a<n;a+=3)for(var i=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;s<4&&a+.75*s<n;s++)o.push(r.charAt(i>>>6*(3-s)&63));var u=r.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var a=0;a<n.length;a++)o[n.charCodeAt(a)]=a}var i=n.charAt(64);if(i){var s=e.indexOf(i);-1!==s&&(t=s)}return r(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)}({get exports(){return Ur},set exports(e){Ur=e}});var Mr=Ur;function Lr(e){if(!Mn(e))return"";return Mr.parse(e).toString(Gr)}function Fr(e){return!!t.existsSync(e)&&(!t.lstatSync(e).isDirectory()&&!t.lstatSync(e).isSymbolicLink())}function Wr(e,t,n){if(!Mn(e))return"";if(!Mn(t))return"";if(!Un(n))return"";let r=new RegExp(t,"g");return String(e).replace(r,n)}var zr=A,Hr=T;var Yr=function(e){return!0===e||!1===e||Hr(e)&&"[object Boolean]"==zr(e)};function qr(e){return Yr(e)}var Jr={};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,r,a,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,a||e,i),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,a=r.length,i=new Array(a);o<a;o++)i[o]=r[o].fn;return i},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,o,a,i){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,a),!0;case 6:return l.fn.call(l.context,t,r,o,a,i),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var p,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,o);break;default:if(!u)for(p=1,u=new Array(f-1);p<f;p++)u[p-1]=arguments[p];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,o){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return i(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||o&&!s.once||r&&s.context!==r||i(this,a);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||o&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[a]=1===c.length?c[0]:c:i(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}({get exports(){return Jr},set exports(e){Jr=e}});var Vr=Jr;function Zr(){return new Vr}var Xr=Re;var Kr=Re,Qr=De,eo=Qe;var to=Re,no=function(){this.__data__=new Xr,this.size=0},ro=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},oo=function(e){return this.__data__.get(e)},ao=function(e){return this.__data__.has(e)},io=function(e,t){var n=this.__data__;if(n instanceof Kr){var r=n.__data__;if(!Qr||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new eo(r)}return n.set(e,t),this.size=n.size,this};function so(e){var t=this.__data__=new to(e);this.size=t.size}so.prototype.clear=no,so.prototype.delete=ro,so.prototype.get=oo,so.prototype.has=ao,so.prototype.set=io;var uo=so;var co=Qe,lo=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},fo=function(e){return this.__data__.has(e)};function po(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new co;++t<n;)this.add(e[t])}po.prototype.add=po.prototype.push=lo,po.prototype.has=fo;var ho=po,mo=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},vo=function(e,t){return e.has(t)};var yo=function(e,t,n,r,o,a){var i=1&n,s=e.length,u=t.length;if(s!=u&&!(i&&u>s))return!1;var c=a.get(e),l=a.get(t);if(c&&l)return c==t&&l==e;var f=-1,p=!0,d=2&n?new ho:void 0;for(a.set(e,t),a.set(t,e);++f<s;){var h=e[f],m=t[f];if(r)var v=i?r(m,h,f,t,e,a):r(h,m,f,e,t,a);if(void 0!==v){if(v)continue;p=!1;break}if(d){if(!mo(t,(function(e,t){if(!vo(d,t)&&(h===e||o(h,e,n,r,a)))return d.push(t)}))){p=!1;break}}else if(h!==m&&!o(h,m,n,r,a)){p=!1;break}}return a.delete(e),a.delete(t),p},go=p.Uint8Array;var bo=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n};var wo=go,jo=je,Oo=yo,So=bo,Ao=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},To=d?d.prototype:void 0,Io=To?To.valueOf:void 0;var Eo=function(e,t,n,r,o,a,i){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new wo(e),new wo(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return jo(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=So;case"[object Set]":var u=1&r;if(s||(s=Ao),e.size!=t.size&&!u)return!1;var c=i.get(e);if(c)return c==t;r|=2,i.set(e,t);var l=Oo(s(e),s(t),r,o,a,i);return i.delete(e),l;case"[object Symbol]":if(Io)return Io.call(e)==Io.call(t)}return!1};var _o=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e},ko=_o,Bo=u;var No=function(e,t,n){var r=t(e);return Bo(e)?r:ko(r,n(e))};var Co=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,a=[];++n<r;){var i=e[n];t(i,n,e)&&(a[o++]=i)}return a};var Po=function(){return[]},xo=Co,Ro=Po,Do=Object.prototype.propertyIsEnumerable,$o=Object.getOwnPropertySymbols,Go=$o?function(e){return null==e?[]:(e=Object(e),xo($o(e),(function(t){return Do.call(e,t)})))}:Ro,Uo=No,Mo=Go,Lo=In;var Fo=function(e){return Uo(e,Lo,Mo)},Wo=Fo,zo=Object.prototype.hasOwnProperty;var Ho=function(e,t,n,r,o,a){var i=1&n,s=Wo(e),u=s.length;if(u!=Wo(t).length&&!i)return!1;for(var c=u;c--;){var l=s[c];if(!(i?l in t:zo.call(t,l)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var d=!0;a.set(e,t),a.set(t,e);for(var h=i;++c<u;){var m=e[l=s[c]],v=t[l];if(r)var y=i?r(v,m,l,t,e,a):r(m,v,l,e,t,a);if(!(void 0===y?m===v||o(m,v,n,r,a):y)){d=!1;break}h||(h="constructor"==l)}if(d&&!h){var g=e.constructor,b=t.constructor;g==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b||(d=!1)}return a.delete(e),a.delete(t),d},Yo=ne(p,"DataView"),qo=De,Jo=ne(p,"Promise"),Vo=ne(p,"Set"),Zo=ne(p,"WeakMap"),Xo=A,Ko=W,Qo="[object Map]",ea="[object Promise]",ta="[object Set]",na="[object WeakMap]",ra="[object DataView]",oa=Ko(Yo),aa=Ko(qo),ia=Ko(Jo),sa=Ko(Vo),ua=Ko(Zo),ca=Xo;(Yo&&ca(new Yo(new ArrayBuffer(1)))!=ra||qo&&ca(new qo)!=Qo||Jo&&ca(Jo.resolve())!=ea||Vo&&ca(new Vo)!=ta||Zo&&ca(new Zo)!=na)&&(ca=function(e){var t=Xo(e),n="[object Object]"==t?e.constructor:void 0,r=n?Ko(n):"";if(r)switch(r){case oa:return ra;case aa:return Qo;case ia:return ea;case sa:return ta;case ua:return na}return t});var la=ca,fa=uo,pa=yo,da=Eo,ha=Ho,ma=la,va=u,ya=Lt,ga=nn,ba="[object Arguments]",wa="[object Array]",ja="[object Object]",Oa=Object.prototype.hasOwnProperty;var Sa=function(e,t,n,r,o,a){var i=va(e),s=va(t),u=i?wa:ma(e),c=s?wa:ma(t),l=(u=u==ba?ja:u)==ja,f=(c=c==ba?ja:c)==ja,p=u==c;if(p&&ya(e)){if(!ya(t))return!1;i=!0,l=!1}if(p&&!l)return a||(a=new fa),i||ga(e)?pa(e,t,n,r,o,a):da(e,t,u,n,r,o,a);if(!(1&n)){var d=l&&Oa.call(e,"__wrapped__"),h=f&&Oa.call(t,"__wrapped__");if(d||h){var m=d?e.value():e,v=h?t.value():t;return a||(a=new fa),o(m,v,n,r,a)}}return!!p&&(a||(a=new fa),ha(e,t,n,r,o,a))},Aa=T;var Ta=function e(t,n,r,o,a){return t===n||(null==t||null==n||!Aa(t)&&!Aa(n)?t!=t&&n!=n:Sa(t,n,r,o,e,a))},Ia=uo,Ea=Ta;var _a=x;var ka=function(e){return e==e&&!_a(e)},Ba=ka,Na=In;var Ca=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}},Pa=function(e,t,n,r){var o=n.length,a=o,i=!r;if(null==e)return!a;for(e=Object(e);o--;){var s=n[o];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<a;){var u=(s=n[o])[0],c=e[u],l=s[1];if(i&&s[2]){if(void 0===c&&!(u in e))return!1}else{var f=new Ia;if(r)var p=r(c,l,u,e,t,f);if(!(void 0===p?Ea(l,c,3,r,f):p))return!1}}return!0},xa=function(e){for(var t=Na(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,Ba(o)]}return t},Ra=Ca;var Da=bt,$a=Mt,Ga=u,Ua=zt,Ma=Ht,La=jt;var Fa=function(e,t,n){for(var r=-1,o=(t=Da(t,e)).length,a=!1;++r<o;){var i=La(t[r]);if(!(a=null!=e&&n(e,i)))break;e=e[i]}return a||++r!=o?a:!!(o=null==e?0:e.length)&&Ma(o)&&Ua(i,o)&&(Ga(e)||$a(e))},Wa=function(e,t){return null!=e&&t in Object(e)},za=Fa;var Ha=function(e,t){return null!=e&&za(e,t,Wa)},Ya=Ta,qa=It,Ja=Ha,Va=P,Za=ka,Xa=Ca,Ka=jt;var Qa=function(e,t){return Va(e)&&Za(t)?Xa(Ka(e),t):function(n){var r=qa(n,e);return void 0===r&&r===t?Ja(n,e):Ya(t,r,3)}};var ei=function(e){return function(t){return null==t?void 0:t[e]}},ti=At;var ni=function(e){return function(t){return ti(t,e)}},ri=ei,oi=ni,ai=P,ii=jt;var si=function(e){return ai(e)?ri(ii(e)):oi(e)},ui=function(e){var t=xa(e);return 1==t.length&&t[0][2]?Ra(t[0][0],t[0][1]):function(n){return n===e||Pa(n,e,t)}},ci=Qa,li=Nn,fi=u,pi=si;var di=function(e){return"function"==typeof e?e:null==e?li:"object"==typeof e?fi(e)?ci(e[0],e[1]):ui(e):pi(e)},hi=Bn,mi=On;var vi=it,yi=di,gi=function(e,t){var n=-1,r=mi(e)?Array(e.length):[];return hi(e,(function(e,o,a){r[++n]=t(e,o,a)})),r},bi=u;var wi=function(e,t){return(bi(e)?vi:gi)(e,yi(t))},ji=ne,Oi=function(){try{var e=ji(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Si=Oi;var Ai=function(e,t,n){"__proto__"==t&&Si?Si(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Ti=Ai,Ii=je,Ei=Object.prototype.hasOwnProperty;var _i=function(e,t,n){var r=e[t];Ei.call(e,t)&&Ii(r,n)&&(void 0!==n||t in e)||Ti(e,t,n)},ki=_i,Bi=Ai;var Ni=function(e,t,n,r){var o=!n;n||(n={});for(var a=-1,i=t.length;++a<i;){var s=t[a],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),o?Bi(n,s,u):ki(n,s,u)}return n},Ci=Ni,Pi=In;var xi=function(e,t){return e&&Ci(t,Pi(t),e)};var Ri=x,Di=dn,$i=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},Gi=Object.prototype.hasOwnProperty;var Ui=fn,Mi=function(e){if(!Ri(e))return $i(e);var t=Di(e),n=[];for(var r in e)("constructor"!=r||!t&&Gi.call(e,r))&&n.push(r);return n},Li=On;var Fi=function(e){return Li(e)?Ui(e,!0):Mi(e)},Wi=Ni,zi=Fi;var Hi=function(e,t){return e&&Wi(t,zi(t),e)},Yi={};!function(e,t){var n=p,r=t&&!t.nodeType&&t,o=r&&e&&!e.nodeType&&e,a=o&&o.exports===r?n.Buffer:void 0,i=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=i?i(n):new e.constructor(n);return e.copy(r),r}}({get exports(){return Yi},set exports(e){Yi=e}},Yi);var qi=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},Ji=Ni,Vi=Go;var Zi=function(e,t){return Ji(e,Vi(e),t)},Xi=hn(Object.getPrototypeOf,Object),Ki=_o,Qi=Xi,es=Go,ts=Po,ns=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ki(t,es(e)),e=Qi(e);return t}:ts,rs=Ni,os=ns;var as=function(e,t){return rs(e,os(e),t)},is=No,ss=ns,us=Fi;var cs=function(e){return is(e,us,ss)},ls=Object.prototype.hasOwnProperty;var fs=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ls.call(e,"index")&&(n.index=e.index,n.input=e.input),n},ps=go;var ds=function(e){var t=new e.constructor(e.byteLength);return new ps(t).set(new ps(e)),t},hs=ds;var ms=function(e,t){var n=t?hs(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},vs=/\w*$/;var ys=function(e){var t=new e.constructor(e.source,vs.exec(e));return t.lastIndex=e.lastIndex,t},gs=d?d.prototype:void 0,bs=gs?gs.valueOf:void 0;var ws=ds;var js=function(e,t){var n=t?ws(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},Os=ds,Ss=ms,As=ys,Ts=function(e){return bs?Object(bs.call(e)):{}},Is=js;var Es=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Os(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return Ss(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Is(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return As(e);case"[object Symbol]":return Ts(e)}},_s=x,ks=Object.create,Bs=function(){function e(){}return function(t){if(!_s(t))return{};if(ks)return ks(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Ns=Xi,Cs=dn;var Ps=function(e){return"function"!=typeof e.constructor||Cs(e)?{}:Bs(Ns(e))},xs=la,Rs=T;var Ds=function(e){return Rs(e)&&"[object Map]"==xs(e)},$s=Xt,Gs=Kt&&Kt.isMap,Us=Gs?$s(Gs):Ds,Ms=la,Ls=T;var Fs=function(e){return Ls(e)&&"[object Set]"==Ms(e)},Ws=Xt,zs=Kt&&Kt.isSet,Hs=zs?Ws(zs):Fs,Ys=uo,qs=kt,Js=_i,Vs=xi,Zs=Hi,Xs=Yi,Ks=qi,Qs=Zi,eu=as,tu=Fo,nu=cs,ru=la,ou=fs,au=Es,iu=Ps,su=u,uu=Lt,cu=Us,lu=x,fu=Hs,pu=In,du=Fi,hu="[object Arguments]",mu="[object Function]",vu="[object Object]",yu={};yu[hu]=yu["[object Array]"]=yu["[object ArrayBuffer]"]=yu["[object DataView]"]=yu["[object Boolean]"]=yu["[object Date]"]=yu["[object Float32Array]"]=yu["[object Float64Array]"]=yu["[object Int8Array]"]=yu["[object Int16Array]"]=yu["[object Int32Array]"]=yu["[object Map]"]=yu["[object Number]"]=yu[vu]=yu["[object RegExp]"]=yu["[object Set]"]=yu["[object String]"]=yu["[object Symbol]"]=yu["[object Uint8Array]"]=yu["[object Uint8ClampedArray]"]=yu["[object Uint16Array]"]=yu["[object Uint32Array]"]=!0,yu["[object Error]"]=yu[mu]=yu["[object WeakMap]"]=!1;var gu=function e(t,n,r,o,a,i){var s,u=1&n,c=2&n,l=4&n;if(r&&(s=a?r(t,o,a,i):r(t)),void 0!==s)return s;if(!lu(t))return t;var f=su(t);if(f){if(s=ou(t),!u)return Ks(t,s)}else{var p=ru(t),d=p==mu||"[object GeneratorFunction]"==p;if(uu(t))return Xs(t,u);if(p==vu||p==hu||d&&!a){if(s=c||d?{}:iu(t),!u)return c?eu(t,Zs(s,t)):Qs(t,Vs(s,t))}else{if(!yu[p])return a?t:{};s=au(t,p,u)}}i||(i=new Ys);var h=i.get(t);if(h)return h;i.set(t,s),fu(t)?t.forEach((function(o){s.add(e(o,n,r,o,t,i))})):cu(t)&&t.forEach((function(o,a){s.set(a,e(o,n,r,a,t,i))}));var m=f?void 0:(l?c?nu:tu:c?du:pu)(t);return qs(m||t,(function(o,a){m&&(o=t[a=o]),Js(s,a,e(o,n,r,a,t,i))})),s},bu=gu;var wu=function(e){return bu(e,5)},ju=A,Ou=u,Su=T;var Au=function(e){return"string"==typeof e||!Ou(e)&&Su(e)&&"[object String]"==ju(e)},Tu=ei("length"),Iu=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Eu=function(e){return Iu.test(e)},_u="\\ud800-\\udfff",ku="["+_u+"]",Bu="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Nu="\\ud83c[\\udffb-\\udfff]",Cu="[^"+_u+"]",Pu="(?:\\ud83c[\\udde6-\\uddff]){2}",xu="[\\ud800-\\udbff][\\udc00-\\udfff]",Ru="(?:"+Bu+"|"+Nu+")"+"?",Du="[\\ufe0e\\ufe0f]?",$u=Du+Ru+("(?:\\u200d(?:"+[Cu,Pu,xu].join("|")+")"+Du+Ru+")*"),Gu="(?:"+[Cu+Bu+"?",Bu,Pu,xu,ku].join("|")+")",Uu=RegExp(Nu+"(?="+Nu+")|"+Gu+$u,"g");var Mu=Tu,Lu=Eu,Fu=function(e){for(var t=Uu.lastIndex=0;Uu.test(e);)++t;return t};var Wu=bn,zu=la,Hu=On,Yu=Au,qu=function(e){return Lu(e)?Fu(e):Mu(e)};var Ju=function(e){if(null==e)return 0;if(Hu(e))return Yu(e)?qu(e):e.length;var t=zu(e);return"[object Map]"==t||"[object Set]"==t?e.size:Wu(e).length};function Vu(e,t){return!!Fn(e)&&(!(!Mn(t)&&!mr(t))&&t in e)}function Zu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Zr(),n={},r=null,o=It(e,"timeAlive");Tr(o)||(o=1e4),o=Ar(o);let a=It(e,"timeDetect");return Tr(a)||(a=50),a=Ar(a),t.trigger=function(e,i){Mn(e)?(Vu(n,e)||setTimeout((()=>{t.emit("message",{eventName:"enter",key:e,data:i,now:Ju(n)})}),1),n[e]={data:i,time:Date.now()},null===r&&(r=setInterval((()=>{Gn(n,((e,r)=>{if(Date.now()-e.time>o){let e=wu(n[r]);delete n[r],t.emit("message",{eventName:"leave",key:r,data:e.data,now:Ju(n)})}})),Wn(n)||(clearInterval(r),r=null)}),a))):console.log("trigger need key")},t.get=function(){let e=[];return Gn(n,((t,n)=>{e.push({key:n,data:t.data})})),e=wu(e),e},t}function Xu(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}function Ku(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}function Qu(e){return"[object Uint16Array]"===Object.prototype.toString.call(e)}function ec(e){if(!(Xu(e)||(t=e,"[object Blob]"===Object.prototype.toString.call(t))||Ku(e)||Qu(e)))return null;var t;try{if(e.byteLength)return e.byteLength}catch(e){}try{if(e.length)return e.length}catch(e){}try{if(e.size)return e.size}catch(e){}return null}var tc=A,nc=Xi,rc=T,oc=Function.prototype,ac=Object.prototype,ic=oc.toString,sc=ac.hasOwnProperty,uc=ic.call(Object);var cc=function(e){if(!rc(e)||"[object Object]"!=tc(e))return!1;var t=nc(e);if(null===t)return!0;var n=sc.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ic.call(n)==uc},lc=A,fc=T,pc=cc;var dc=function(e){if(!fc(e))return!1;var t=lc(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!pc(e)};function hc(e){if(!Mn(e))return new Uint8Array;let t;try{t=function(e){if(!Un(e))return new Uint8Array;let t=Mr.parse(e),n=t.words,r=t.sigBytes,o=new Uint8Array(r);for(let e=0;e<r;e++){let t=n[e>>>2]>>>24-e%4*8&255;o[e]=t}return o}(function(e){if(!Mn(e))return"";let t=Gr.parse(e);return Mr.stringify(t)}(e))}catch(e){return new Uint8Array}return t}function mc(e,t){return function(e,t,n,r,o,a){if(!mr(e))return null;if(!Ku(t))return null;if(!yr(n))return null;if(!qr(r))return null;if(!yr(o))return null;if(!yr(a))return null;let i,s,u;e=vr(e);let c=8*a-o-1,l=(1<<c)-1,f=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?a-1:0,h=r?-1:1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,i=l):(i=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-i))<1&&(i--,u*=2),(e+=i+f>=1?p/u:p*Math.pow(2,1-f))*u>=2&&(i++,u/=2),i+f>=l?(s=0,i=l):i+f>=1?(s=(e*u-1)*Math.pow(2,o),i+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,o),i=0));o>=8;t[n+d]=255&s,d+=h,s/=256,o-=8);for(i=i<<o|s,c+=o;c>0;t[n+d]=255&i,d+=h,i/=256,c-=8);return t[n+d-h]|=128*m,null}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,!(arguments.length>3&&void 0!==arguments[3])||arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:52,arguments.length>5&&void 0!==arguments[5]?arguments[5]:8)}function vc(e){let t=[],n=[];if(!Vn(e)&&!Wn(e))return null;let r=[],o=[];function a(e){r.push(ec(e)),o.push(e)}try{let i=function(e){if(!Fn(e))return{results:"",binarys:[]};if(Yn(e))return{results:"",binarys:[]};let t="",n=[];try{let r=-1;t=JSON.stringify(e,(function(e,t){if(Ku(t)){r+=1;let e=`[Uint8Array]::${r}`;return n.push(t),e}if(Qu(t)){r+=1;let e=`[Uint16Array]::${r}`;return n.push(t),e}if(Xu(t)){r+=1;let e=`[ArrayBuffer]::${r}`;return n.push(t),e}return dc(t)&&(t=t.toString()),t}))}catch(e){}return{results:t,binarys:n}}(e);a(hc(i.results)),Gn(i.binarys,(e=>{a(e)}));let s=r,u=hc(JSON.stringify(s)),c=new Uint8Array(8);mc(ec(u),c),t.push(c),t.push(u),Gn(o,(e=>{t.push(e)})),Gn(t,(e=>{n=function(e,t){let n=ec(e),r=ec(t),o=new Uint8Array(n+r);return o.set(new Uint8Array(e),0),o.set(new Uint8Array(t),n),o}(n,e)}))}catch(e){return null}return n}function yc(e){return function(e,t,n,r,o){if(!Ku(e))return null;if(!yr(t))return null;if(!qr(n))return null;if(!yr(r))return null;if(!yr(o))return null;let a,i,s=8*o-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?0:o-1,p=n?1:-1,d=e[t+f];for(f+=p,a=d&(1<<-l)-1,d>>=-l,l+=s;l>0;a=256*a+e[t+f],f+=p,l-=8);for(i=a&(1<<-l)-1,a>>=-l,l+=r;l>0;i=256*i+e[t+f],f+=p,l-=8);if(0===a)a=1-c;else{if(a===u)return i?NaN:1/0*(d?-1:1);i+=Math.pow(2,r),a-=c}return(d?-1:1)*i*Math.pow(2,a-r)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!(arguments.length>2&&void 0!==arguments[2])||arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:52,arguments.length>4&&void 0!==arguments[4]?arguments[4]:8)}var gc={};!function(e,t){var n;e.exports=(n=$r(),function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init,r=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=e[o]<<24-o%4*8;t.call(this,r,n)}else t.apply(this,arguments)};r.prototype=e}}(),n.lib.WordArray)}({get exports(){return gc},set exports(e){gc=e}});var bc=gc;function wc(e){if(!Ku(e))return"";let t;try{t=Lr(function(e){return Ku(e)?bc.create(e).toString(Mr):""}(e))}catch(e){return""}return t}function jc(e){let t=null;if(!Ku(e))return null;try{let n=8,r=e.slice(0,n),o=e.slice(n,ec(e)),a=yc(r),i=o.slice(0,a),s=o.slice(a,ec(o)),u=wc(i),c=function(e,t){let n=0,r=0,o=[];return Gn(t,(t=>{r=n+t;let a=e.slice(n,r);n=r,o.push(a)})),o}(s,JSON.parse(u));t=function(e){if(!Wn(e))return{};let{results:t,binarys:n}=e;if(!Mn(t))return{};if(!zn(n))return{};let r={};try{r=JSON.parse(t,(function(e,t){if(Mn(t)){if(t.indexOf("[Uint8Array]::")>=0){let e=Ar(t.replace("[Uint8Array]::",""));return n[e]}if(t.indexOf("[Uint16Array]::")>=0){let e=Ar(t.replace("[Uint16Array]::",""));return n[e]}if(t.indexOf("[ArrayBuffer]::")>=0){let e=Ar(t.replace("[ArrayBuffer]::",""));return n[e]}}return t}))}catch(e){}return r}({results:wc(c.shift()),binarys:c})}catch(e){}return t}function Oc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};e.port||(e.port=8080),e.apiName||(e.apiName="api");let i,s=new o.EventEmitter,u=Zu();function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];setTimeout((()=>{s.emit(e,...n)}),1)}async function l(e){let n=Nr(),r=Nr(),o=It(e,"_mode","");if(r.then((t=>{e.output=t,delete e.input,n.resolve(e)})).catch((e=>{n.reject(e)})),"execute"===o){c("execute",It(e,"func",""),It(e,"input",null),r)}else if("broadcast"===o){c("broadcast",It(e,"input",null)),r.resolve("ok")}else if("deliver"===o){c("deliver",It(e,"input",null)),r.resolve("ok")}else if("polling"===o){let n=It(e,"clientId",""),o=It(t,n,[]);o=wu(o),t[n]=[],r.resolve(o)}else{let t="can not find _mode in data";!function(e,t){c("error",{msg:e,err:t})}(t,e),n.reject(t),r.reject()}return n}setInterval((()=>{let e=u.get(),n=wi(e,"key"),r={};Gn(n,(e=>{r[e]=It(t,e,[])})),t=r}),1e3),i=e.serverHapi?e.serverHapi:n.server({port:e.port,routes:{cors:{origin:["*"]}}}),c("open"),u.on("message",(function(e){let{eventName:t,key:n,data:r,now:o}=e;"enter"===t?c("clientEnter",n,r):"leave"===t&&c("clientLeave",n,r),c("clientChange",o)}));let f={path:"/"+e.apiName,method:"POST",options:{payload:{maxBytes:1073741824,timeout:18e4,multipart:!0},timeout:{socket:3e5}},handler:async function(e,t){let n=It(e,"headers");n=Wn(n)?n:"";let r=It(e,"query");r=Wn(r)?r:"",c("handler",{headers:n,query:r});let o=It(e,"payload.bb",null);Un(o)&&(o=Buffer.from(o,"utf8"));let i=jc(new Uint8Array(o)),s=It(i,"clientId"),f={headers:e.headers,info:e.info};u.trigger(s,f);let p={};await l(i).then((function(e){p.success=e})).catch((function(e){p.error=e}));let d=vc(p),h=new a.Readable;return h._read=()=>{},h.push(d),h.push(null),t.response(h).header("Cache-Control","no-cache, no-store, must-revalidate").header("Content-Type","application/octet-stream").header("Content-Length",h.readableLength)}};return s.broadcast=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(Jn(t))return;let r={};Gn(t,((t,n)=>{t.push({mode:"broadcast",data:e}),r[n]=t})),t=r,n(100)},s.deliver=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=It(t,e,[]);o.push({mode:"deliver",data:n}),t[e]=o,r(100)},e.serverHapi?e.serverHapi.route(f):async function(){await i.register(r),i.route([{method:"GET",path:"/{file*}",handler:{directory:{path:"./"}}},f]),await i.start(),console.log(`Server running at: ${i.info.uri}`)}(),s}let Sc="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Ac=Sc.length;function Tc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,t=[];e=Tr(e)?Ar(e):32;for(let n=0;n<e;n++)t[n]=Sc[0|Math.random()*Ac];return t.join("")}var Ic=p,Ec=x,_c=function(){return Ic.Date.now()},kc=sr,Bc=Math.max,Nc=Math.min;var Cc=function(e,t,n){var r,o,a,i,s,u,c=0,l=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function d(t){var n=r,a=o;return r=o=void 0,c=t,i=e.apply(a,n)}function h(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-c>=a}function m(){var e=_c();if(h(e))return v(e);s=setTimeout(m,function(e){var n=t-(e-u);return f?Nc(n,a-(e-c)):n}(e))}function v(e){return s=void 0,p&&r?d(e):(r=o=void 0,i)}function y(){var e=_c(),n=h(e);if(r=arguments,o=this,u=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(m,t),l?d(e):i}(u);if(f)return clearTimeout(s),s=setTimeout(m,t),d(u)}return void 0===s&&(s=setTimeout(m,t)),i}return t=kc(t)||0,Ec(n)&&(l=!!n.leading,a=(f="maxWait"in n)?Bc(kc(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=u=o=s=void 0},y.flush=function(){return void 0===s?i:v(_c())},y},Pc=Ai,xc=je;var Rc=function(e,t,n){(void 0!==n&&!xc(e[t],n)||void 0===n&&!(t in e))&&Pc(e,t,n)},Dc=On,$c=T;var Gc=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},Uc=Ni,Mc=Fi;var Lc=Rc,Fc=Yi,Wc=js,zc=qi,Hc=Ps,Yc=Mt,qc=u,Jc=function(e){return $c(e)&&Dc(e)},Vc=Lt,Zc=G,Xc=x,Kc=cc,Qc=nn,el=Gc,tl=function(e){return Uc(e,Mc(e))};var nl=uo,rl=Rc,ol=Bt,al=function(e,t,n,r,o,a,i){var s=el(e,n),u=el(t,n),c=i.get(u);if(c)Lc(e,n,c);else{var l=a?a(s,u,n+"",e,t,i):void 0,f=void 0===l;if(f){var p=qc(u),d=!p&&Vc(u),h=!p&&!d&&Qc(u);l=u,p||d||h?qc(s)?l=s:Jc(s)?l=zc(s):d?(f=!1,l=Fc(u,!0)):h?(f=!1,l=Wc(u,!0)):l=[]:Kc(u)||Yc(u)?(l=s,Yc(s)?l=tl(s):Xc(s)&&!Zc(s)||(l=Hc(u))):f=!1}f&&(i.set(u,l),o(l,u,r,a,i),i.delete(u)),Lc(e,n,l)}},il=x,sl=Fi,ul=Gc;var cl=function e(t,n,r,o,a){t!==n&&ol(n,(function(i,s){if(a||(a=new nl),il(i))al(t,n,s,r,e,o,a);else{var u=o?o(ul(t,s),i,s+"",t,n,a):void 0;void 0===u&&(u=i),rl(t,s,u)}}),sl)};var ll=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},fl=Math.max;var pl=function(e,t,n){return t=fl(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=fl(r.length-t,0),i=Array(a);++o<a;)i[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(i),ll(e,this,s)}};var dl=function(e){return function(){return e}},hl=Oi,ml=hl?function(e,t){return hl(e,"toString",{configurable:!0,enumerable:!1,value:dl(t),writable:!0})}:Nn,vl=Date.now;var yl=function(e){var t=0,n=0;return function(){var r=vl(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},gl=yl(ml),bl=Nn,wl=pl,jl=gl;var Ol=je,Sl=On,Al=zt,Tl=x;var Il=function(e,t){return jl(wl(e,t,bl),e+"")},El=function(e,t,n){if(!Tl(n))return!1;var r=typeof t;return!!("number"==r?Sl(n)&&Al(t,n.length):"string"==r&&t in n)&&Ol(n[t],e)};var _l=cl,kl=function(e){return Il((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,i=o>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,i&&El(n[0],n[1],i)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,a)}return t}))}((function(e,t,n){_l(e,t,n)})),Bl={};!function(e,t){e.exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",o="second",a="minute",i="hour",s="day",u="week",c="month",l="quarter",f="year",p="date",d="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},y=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},g={s:y,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),o=n%60;return(t<=0?"+":"-")+y(r,2,"0")+":"+y(o,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),o=t.clone().add(r,c),a=n-o<0,i=t.clone().add(r+(a?-1:1),c);return+(-(r+(n-o)/(a?o-i:i-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:f,w:u,d:s,D:p,h:i,m:a,s:o,ms:r,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=v;var j="$isDayjsObject",O=function(e){return e instanceof I||!(!e||!e[j])},S=function e(t,n,r){var o;if(!t)return b;if("string"==typeof t){var a=t.toLowerCase();w[a]&&(o=a),n&&(w[a]=n,o=a);var i=t.split("-");if(!o&&i.length>1)return e(i[0])}else{var s=t.name;w[s]=t,o=s}return!r&&o&&(b=o),o||!r&&b},A=function(e,t){if(O(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new I(n)},T=g;T.l=S,T.i=O,T.w=function(e,t){return A(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var I=function(){function v(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[j]=!0}var y=v.prototype;return y.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(T.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(h);if(r){var o=r[2]-1||0,a=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.init()},y.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},y.$utils=function(){return T},y.isValid=function(){return!(this.$d.toString()===d)},y.isSame=function(e,t){var n=A(e);return this.startOf(t)<=n&&n<=this.endOf(t)},y.isAfter=function(e,t){return A(e)<this.startOf(t)},y.isBefore=function(e,t){return this.endOf(t)<A(e)},y.$g=function(e,t,n){return T.u(e)?this[t]:this.set(n,e)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(e,t){var n=this,r=!!T.u(t)||t,l=T.p(e),d=function(e,t){var o=T.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?o:o.endOf(s)},h=function(e,t){return T.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,v=this.$M,y=this.$D,g="set"+(this.$u?"UTC":"");switch(l){case f:return r?d(1,0):d(31,11);case c:return r?d(1,v):d(0,v+1);case u:var b=this.$locale().weekStart||0,w=(m<b?m+7:m)-b;return d(r?y-w:y+(6-w),v);case s:case p:return h(g+"Hours",0);case i:return h(g+"Minutes",1);case a:return h(g+"Seconds",2);case o:return h(g+"Milliseconds",3);default:return this.clone()}},y.endOf=function(e){return this.startOf(e,!1)},y.$set=function(e,t){var n,u=T.p(e),l="set"+(this.$u?"UTC":""),d=(n={},n[s]=l+"Date",n[p]=l+"Date",n[c]=l+"Month",n[f]=l+"FullYear",n[i]=l+"Hours",n[a]=l+"Minutes",n[o]=l+"Seconds",n[r]=l+"Milliseconds",n)[u],h=u===s?this.$D+(t-this.$W):t;if(u===c||u===f){var m=this.clone().set(p,1);m.$d[d](h),m.init(),this.$d=m.set(p,Math.min(this.$D,m.daysInMonth())).$d}else d&&this.$d[d](h);return this.init(),this},y.set=function(e,t){return this.clone().$set(e,t)},y.get=function(e){return this[T.p(e)]()},y.add=function(r,l){var p,d=this;r=Number(r);var h=T.p(l),m=function(e){var t=A(d);return T.w(t.date(t.date()+Math.round(e*r)),d)};if(h===c)return this.set(c,this.$M+r);if(h===f)return this.set(f,this.$y+r);if(h===s)return m(1);if(h===u)return m(7);var v=(p={},p[a]=t,p[i]=n,p[o]=e,p)[h]||1,y=this.$d.getTime()+r*v;return T.w(y,this)},y.subtract=function(e,t){return this.add(-1*e,t)},y.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=e||"YYYY-MM-DDTHH:mm:ssZ",o=T.z(this),a=this.$H,i=this.$m,s=this.$M,u=n.weekdays,c=n.months,l=n.meridiem,f=function(e,n,o,a){return e&&(e[n]||e(t,r))||o[n].slice(0,a)},p=function(e){return T.s(a%12||12,e,"0")},h=l||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(m,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return T.s(t.$y,4,"0");case"M":return s+1;case"MM":return T.s(s+1,2,"0");case"MMM":return f(n.monthsShort,s,c,3);case"MMMM":return f(c,s);case"D":return t.$D;case"DD":return T.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return f(n.weekdaysMin,t.$W,u,2);case"ddd":return f(n.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(a);case"HH":return T.s(a,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return h(a,i,!0);case"A":return h(a,i,!1);case"m":return String(i);case"mm":return T.s(i,2,"0");case"s":return String(t.$s);case"ss":return T.s(t.$s,2,"0");case"SSS":return T.s(t.$ms,3,"0");case"Z":return o}return null}(e)||o.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(r,p,d){var h,m=this,v=T.p(p),y=A(r),g=(y.utcOffset()-this.utcOffset())*t,b=this-y,w=function(){return T.m(m,y)};switch(v){case f:h=w()/12;break;case c:h=w();break;case l:h=w()/3;break;case u:h=(b-g)/6048e5;break;case s:h=(b-g)/864e5;break;case i:h=b/n;break;case a:h=b/t;break;case o:h=b/e;break;default:h=b}return d?h:T.a(h)},y.daysInMonth=function(){return this.endOf(c).$D},y.$locale=function(){return w[this.$L]},y.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=S(e,t,!0);return r&&(n.$L=r),n},y.clone=function(){return T.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},v}(),E=I.prototype;return A.prototype=E,[["$ms",r],["$s",o],["$m",a],["$H",i],["$W",s],["$M",c],["$y",f],["$D",p]].forEach((function(e){E[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),A.extend=function(e,t){return e.$i||(e(t,I,A),e.$i=!0),A},A.locale=S,A.isDayjs=O,A.unix=function(e){return A(1e3*e)},A.en=w[b],A.Ls=w,A.p={},A}()}({get exports(){return Bl},set exports(e){Bl=e}});var Nl=Bl;let Cl=e.resolve();function Pl(){let e={},n=It(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},"fnTableTags");Mn(n)||(n="tableTags.json"),n=`${Cl}/${n}`;let r=Zr();function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];setTimeout((()=>{r.emit(e,...n)}),1)}function a(){let e={};try{if(t.existsSync(n)){let r=Ln(t.readFileSync(n,"utf8"));Wn(r)&&(e=r)}}catch(e){o("error",{msg:"readTableTags catch",err:e})}return e}function i(){try{let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Hn(e))return"";let n="";try{n=t?JSON.stringify(e,null,2):JSON.stringify(e)}catch(e){n=""}return n}(e);t.writeFileSync(n,r,"utf8")}catch(e){o("error",{msg:"writeTableTags catch",err:e})}}let s=Cc((()=>{i(),o("changeTableTags",e)}),200);return r.readTableTags=a,r.writeTableTags=i,r.initTableTags=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"useInputFirst";e="useStorageFirst"===n?kl(t,a()):"useInputOnly"===n?t:"useStorageOnly"===n?a():kl(a(),t),i()},r.setTableTags=function(){e=kl(e,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),i()},r.getTableTags=function(){return e},r.updateTableTag=function(t){e[t]=Nl().format("YYYY-MM-DDTHH:mm:ssZ")+"|"+Tc(6),s()},r}function xl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Zr(),n=It(e,"instWConverServer",null);if(null===n)return t.emit("error","invalid opt.instWConverServer"),t;let r=It(e,"dbORMs",null);if(!Fn(r))return t.emit("error","invalid opt.dbORMs"),t;let o=It(e,"tableNames",null);if(!zn(o))return t.emit("error","invalid opt.tableNames"),t;0===Ju(o)&&console.log("opt.tableNames.lenght = 0");let a=It(e,"fnTableTags",null);Mn(a)||(a="tableTags.json");let i=new Pl({fnTableTags:a});o=wu(o);let s={};function u(e){let t={};return Gn(o,(n=>{let r=n,o=e[n];t[r]=o})),t}return Gn(o,(e=>{s[e]=Tc(6)})),i.initTableTags(s,"useInputOnly"),Gn(o,(e=>{let t=r[e];if(!t)throw new Error(`invalid dbORMs.${e}`);t.on("change",(()=>{i.updateTableTag(e)}))})),n.on("clientEnter",(function(e,t){n.deliver(e,{mode:"syncTable",data:i.readTableTags()})})),i.on("changeTableTags",(e=>{n.broadcast({mode:"syncTable",data:u(e)})})),i}function Rl(e){return Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rl(e)}function Dl(e){var t=function(e,t){if("object"!==Rl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Rl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Rl(t)?t:String(t)}function $l(e,t,n){return(t=Dl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ul(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gl(Object(n),!0).forEach((function(t){$l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let Ml={},Ll=null;async function Fl(e){let{func:t,input:n,pm:r}=e,o="";if(!Vu(n,"__sysToken__"))return r.resolve({state:"error",msg:"invalid token"}),r;if(o=function(e){if(!Mn(e)&&!mr(e)&&!_(e))return"";let t="";try{t=String(e)}catch(e){}try{t=e.toString()}catch(e){}return t}(n.__sysToken__),!Vu(n,"__sysInputArgs__"))return r.resolve({state:"error",msg:"invalid input"}),r;n=n.__sysInputArgs__;let a="",i=Ll(o);if(a=Er(i)?await i:i,Mn(a)||(a=""),"getFuncList"===t){let e={state:"success",msg:In(Ml)};return r.resolve(e),r}if(!Vu(Ml,t))return r.resolve({state:"error",msg:`invalid func[${t}]`}),r;let s=Ml[t];try{let e=await Cr(s)(a,...n);r.resolve(e)}catch(e){r.resolve({state:"error",msg:`無法識別func: ${t}`})}return r}function Wl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Zr(),n=It(e,"instWConverServer",null);if(null===n)return t.emit("error","invalid opt.instWConverServer"),t;Ll=It(e,"cbGetUserIDFromToken",null),Ir(Ll)||(Ll=async()=>"");let r=It(e,"useDbORM",null);qr(r)||(r=!0);let o=null;if(r&&(o=It(e,"operORM",null),!Ir(o)))return t.emit("error","invalid opt.operORM when useDbORM=true"),t;let a=[];if(r&&(a=It(e,"tableNames",null),!zn(a)))return t.emit("error","invalid opt.tableNames when useDbORM=true"),t;let i=[];r&&(i=It(e,"methods",null),zn(i)||(i=["select","insert","save","del"]));let s=It(e,"extFuncs",null),u=It(e,"hookBefores",null),c=It(e,"hookAfters",null),l={};return r&&(a=wu(a),l=function(e,t,n){let r={};return Gn(e,(e=>{Gn(t,(t=>{r[`${e}.${t}`]=async function(r,o){return await n(r,e,t,o)}}))})),r}(a,i,o)),Fn(s)&&Gn(s,((e,t)=>{l[t]=e})),Ml=l,n.on("execute",(async function(e,n,r){let o={func:e,input:n,pm:r};if(Ir(u))try{u(o)}catch(e){t.emit("error",e)}else Vn(u)&&Gn(u,(e=>{if(Ir(e))try{e(o)}catch(e){t.emit("error",e)}}));let a=await Fl(o).catch((e=>{t.emit("error",e)})),i=Ul(Ul({},o),{},{output:a});if(Ir(c))try{c(i)}catch(e){t.emit("error",e)}else Vn(c)&&Gn(c,(e=>{if(Ir(e))try{e(i)}catch(e){t.emit("error",e)}}))})),t}function zl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null,n=null,r=Zr(),o=It(e,"instWConverServer",null);if(null===o)return r.emit("error","invalid opt.instWConverServer"),r;let a=It(e,"useDbORM",null);qr(a)||(a=!0);let i=It(e,"dbORMs",null),s=It(e,"operORM",null),u=It(e,"tableNamesExec",null),c=It(e,"methodsExec",null),l=It(e,"tableNamesSync",null),f=It(e,"cbGetUserIDFromToken",null),p=It(e,"extFuncs",null),d=It(e,"hookBefores",null),h=It(e,"hookAfters",null),m=It(e,"fnTableTags",null);if(t=new Wl({instWConverServer:o,cbGetUserIDFromToken:f,useDbORM:a,operORM:s,tableNames:u,methods:c,extFuncs:p,hookBefores:d,hookAfters:h}),t.on("error",(e=>{r.emit("error",e)})),a){if(!Fn(i))return r.emit("error","invalid opt.dbORMs when useDbORM=true"),r;n=new xl({instWConverServer:o,dbORMs:i,tableNames:l,fnTableTags:m}),n.on("error",(e=>{r.emit("error",e)}))}return r.getInstWServWebdataServerExec=()=>t,r.getInstWServWebdataServerSync=()=>n,r}function Hl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null,o=null,a=null,i=Zr(),s=It(e,"port");yr(s)||(s=8080);let u=It(e,"useCors");qr(u)||(u=!0);let c=It(e,"useInert");qr(c)||(c=!0);let l=It(e,"pathStaticFiles");Mn(l)||(l="dist");let f=It(e,"apis");Vn(f)||(f=[]);let p=It(e,"getUserIDFromToken",null),d=It(e,"useDbORM",null);qr(d)||(d=!0);let h=It(e,"dbORMs",null),m=It(e,"operORM",null),v=It(e,"tableNamesExec",null),y=It(e,"methodsExec",null),g=It(e,"tableNamesSync",null),b=It(e,"extFuncs",null),w=It(e,"hookBefores",null),j=It(e,"hookAfters",null),O=It(e,"fnTableTags",null),S=It(e,"showLog");qr(S)||(S=!0);return(async()=>{await(async()=>{t=new n.Server({port:s,routes:{cors:u}}),c&&await t.register(r);let e=[];c&&(e=[{method:"GET",path:"/{file*}",handler:{directory:{path:`${l}/`}}}]),e=[...e,...f],t.route(e)})(),await(async()=>{o=new Oc({serverHapi:t}),o.on("open",(function(){S&&console.log(`Server[port:${s}]: open`)})),o.on("error",(function(e){S&&console.log(`Server[port:${s}]: error`,e),i.emit("error",{mode:"instWConverhpServer error",err:e})})),o.on("clientChange",(function(e){S&&console.log(`Server[port:${s}]: now clients: ${e}`)}))})(),await(async()=>{a=new zl({instWConverServer:o,cbGetUserIDFromToken:p,useDbORM:d,dbORMs:h,operORM:m,tableNamesExec:v,tableNamesSync:g,methodsExec:y,extFuncs:b,hookBefores:w,hookAfters:j,fnTableTags:O}),a.on("error",(e=>{S&&console.log("error",e),i.emit("error",{mode:"instWServWebdataServer error",err:e})}))})(),await t.start(),S&&console.log(`Server running at: ${t.info.uri}`)})(),process.on("unhandledRejection",(e=>{console.log("unhandledRejection",e),i.emit("error",{mode:"unhandledRejection",err:e})})),process.on("uncaughtException",(e=>{console.log("uncaughtException",e),i.emit("error",{mode:"uncaughtException",err:e})})),i.getServer=()=>t,i.getInstWConverhpServer=()=>o,i.getInstWServWebdataServer=()=>a,i}var Yl=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(o);++r<o;)a[r]=e[r+t];return a},ql=Yl;var Jl=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:ql(e,t,n)};var Vl=function(e,t,n,r){for(var o=e.length,a=n+(r?1:-1);r?a--:++a<o;)if(t(e[a],a,e))return a;return-1},Zl=function(e){return e!=e},Xl=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1};var Kl=function(e,t,n){return t==t?Xl(e,t,n):Vl(e,Zl,n)},Ql=Kl;var ef=function(e,t){for(var n=e.length;n--&&Ql(t,e[n],0)>-1;);return n},tf=Kl;var nf=function(e,t){for(var n=-1,r=e.length;++n<r&&tf(t,e[n],0)>-1;);return n};var rf=function(e){return e.split("")},of="\\ud800-\\udfff",af="["+of+"]",sf="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",uf="\\ud83c[\\udffb-\\udfff]",cf="[^"+of+"]",lf="(?:\\ud83c[\\udde6-\\uddff]){2}",ff="[\\ud800-\\udbff][\\udc00-\\udfff]",pf="(?:"+sf+"|"+uf+")"+"?",df="[\\ufe0e\\ufe0f]?",hf=df+pf+("(?:\\u200d(?:"+[cf,lf,ff].join("|")+")"+df+pf+")*"),mf="(?:"+[cf+sf+"?",sf,lf,ff,af].join("|")+")",vf=RegExp(uf+"(?="+uf+")|"+mf+hf,"g");var yf=rf,gf=Eu,bf=function(e){return e.match(vf)||[]};var wf=pt,jf=Qn,Of=Jl,Sf=ef,Af=nf,Tf=function(e){return gf(e)?bf(e):yf(e)},If=ht;var Ef=function(e,t,n){if((e=If(e))&&(n||void 0===t))return jf(e);if(!e||!(t=wf(t)))return e;var r=Tf(e),o=Tf(t),a=Af(r,o),i=Sf(r,o)+1;return Of(r,a,i).join("")},_f=Yl,kf=pr;var Bf=function(e,t,n){var r=null==e?0:e.length;return r?(t=n||void 0===t?1:kf(t),_f(e,t<0?0:t,r)):[]};function Nf(e,t){let n=Nr();if(!zn(e)&&!Fn(e))return n.reject("rs is not an array or object"),n;let r=!1;if(Fn(e)){r=!0;let t=[];Gn(e,((e,n)=>{t.push({k:n,v:e})})),e=t}Ir(t)||(t=function(e){return e});let o=-1,a=[];return e.reduce((function(e,n){return e.then((function(e){a.push(e),o+=1;let i=o,s=n;return r&&(i=n.k,s=n.v),Ir(t)?t(s,i):s}))}),Promise.resolve()).then((function(e){a.push(e),a=Bf(a),n.resolve(a)})).catch((function(e){n.reject(e)})),n}let Cf={backup:async function(e){return await Nf(e,(async(e,t)=>(console.log("backup...",t),{name:t,data:await e.select()})))},recover:async function(e,n,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Fr(e))throw console.log("fp",e),new Error("fp is not exist");if(!Wn(n))throw console.log("woItems",n),new Error("invalid woItems");Ir(r)||(r=null),qr(o)||(o=!1);let a=t.readFileSync(e,"utf8");a=Ef(a);let i=Ln(a);Ir(r)&&r(),await Nf(i,(async e=>{console.log("recover...",e.name),o&&(console.log("needCreateStorage"),await n[e.name].createStorage());let t=null;return Ju(e.data)>0&&(t=await n[e.name].insert(e.data)),t}))}};function Pf(){return Nl().format("YYYY-MM-DDTHH:mm:ss.SSSZ")}let xf=null,Rf=null;function Df(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"save";if(!Wn(xf))throw console.log("ds",xf),new Error("invalid ds");let o=xf[e].keys,a=!1;zn(n)||(a=!0,n=[n]);let i=Pf();return r.indexOf("insert")>=0&&(o.indexOf("userId")>=0&&Gn(n,((e,r)=>{n[r].userId=t})),o.indexOf("timeCreate")>=0&&Gn(n,((e,t)=>{n[t].timeCreate=i}))),(r.indexOf("insert")>=0||r.indexOf("save")>=0)&&(o.indexOf("userIdUpdate")>=0&&Gn(n,((e,r)=>{n[r].userIdUpdate=t})),o.indexOf("timeUpdate")>=0&&Gn(n,((e,t)=>{n[t].timeUpdate=i}))),n=a?n[0]:n}async function $f(e,t,n,r){let o,a=null;if(!Wn(Rf))return Promise.reject("無有效woItems");let i=It(Rf,t,null);if(null===i)return Promise.reject(`ORM找不到表名稱: ${t}`);if("select"===n){if(o=await i.select(r).catch((e=>{console.log(`${t}.select catch`,e),a="取得資料失敗"})),Mn(a))return Promise.reject(a)}else if("insert"===n||"save"===n){try{r=Df(t,e,r,n)}catch(e){return console.log("adjustData catch",e.toString()),a="調整資料失敗",Promise.reject(a)}if("insert"===n?o=await i.insert(r).catch((e=>{console.log(`${t}.save catch`,e),a="新增資料失敗"})):"save"===n&&(o=await i.save(r,{atomic:!0}).catch((e=>{console.log(`${t}.save catch`,e),a="儲存資料失敗"}))),Mn(a))return Promise.reject(a);o=zn(r)?wi(r,(e=>({id:e.id}))):{id:r.id}}else if("del"===n)o=await i.del(r).catch((e=>{console.log(`${t}.del catch`,e),a="刪除資料失敗"}));else if("delAll"===n)o=await i.delAll(r).catch((e=>{console.log(`${t}.delAll catch`,e),a="刪除資料失敗"}));else if("mix"===n){if(!Wn(r))return Promise.reject("mix僅支援輸入ltdtDiffByKey結果物件");let n;o=[];let s=It(r,"add",[]);if(Ju(s)>0){try{s=Df(t,e,s,"insert+save")}catch(e){return console.log("adjustData catch",e.toString()),a="調整資料失敗",Promise.reject(a)}if(await i.insert(s).catch((e=>{console.log(`${t}.save catch`,e),a="新增資料失敗"})),Mn(a))return Promise.reject(a);n=wi(s,(e=>({id:e.id}))),o=[...o,...n]}let u=It(r,"del",[]);if(Ju(u)>0){if(await i.del(u).catch((e=>{console.log(`${t}.save catch`,e),a="刪除資料失敗"})),Mn(a))return Promise.reject(a);n=wi(u,(e=>({id:e.id}))),o=[...o,...n]}let c=It(r,"diff",[]);if(Ju(c)>0){try{c=Df(t,e,c)}catch(e){return console.log("adjustData catch",e.toString()),a="調整資料失敗",Promise.reject(a)}if(await i.save(c).catch((e=>{console.log(`${t}.save catch`,e),a="變更資料失敗"})),Mn(a))return Promise.reject(a);n=wi(c,(e=>({id:e.id}))),o=[...o,...n]}}else a=`invalid mode: ${n}`;return Mn(a)?Promise.reject(a):o}function Gf(e,t){return xf=e,Rf=t,$f}var Uf=Bn;var Mf=Co,Lf=function(e,t){var n=[];return Uf(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n},Ff=di,Wf=u;var zf=function(e,t){return(Wf(e)?Mf:Lf)(e,Ff(t))};function Hf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!zn(e)){let e=Nr();return e.reject("pms is not an array"),e}return e.reduce(((e,t)=>e.then(t)),Promise.resolve(t))}let Yf=[],qf=[],Jf=[],Vf=null,Zf=null,Xf=!0,Kf=!0;function Qf(e){setTimeout((()=>{Yf.push(e)}),1)}function ep(e){setTimeout((()=>{qf.push(e)}),1)}function tp(e){setTimeout((()=>{Jf.push(e)}),1)}async function np(e,t,n,r){if(!Ir(Vf))return Promise.reject("invalid mapOrm");if(Xf&&!Mn(e))return console.log(`找不到使用者主鍵: (${e})`),Promise.reject("找不到使用者主鍵");let o="n";if(Xf){if(!Ir(Zf))return Promise.reject("invalid getUserById");let t=await Zf(e);if(!t)return console.log(`找不到使用者資訊: (${e})`),Promise.reject("找不到使用者資訊");o=It(t,"isAdmin"),"y"!==o&&"n"!==o&&(o="n");let n=It(t,"isActive");if("y"!==n&&"n"!==n&&(n="n"),"y"!==n)return console.log(`使用者被停權或無有效使用者資訊: (${e})`),Promise.reject("使用者被停權或無有效使用者資訊")}if(await Nf(Yf,(a=>a({woName:t,userId:e,isAdmin:o,mode:n,input:r}))),Ju(qf)>0){let a={woName:t,userId:e,isAdmin:o,mode:n,input:r},i=await Hf(qf,a);r=i.input}let a=await Vf(e,t,n,r);return Kf&&"n"===o&&"select"===n&&zn(a)&&(a=zf(a,(e=>!Vu(e,"isActive")||!("n"===e.isActive)))),Ju(Jf)>0&&(a=await Hf(Jf,{woName:t,userId:e,isAdmin:o,mode:n,input:r,output:a})),a}function rp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function op(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rp(Object(n),!0).forEach((function(t){$l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ap(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=function(e,t,n,r){if(!Wn(e))throw console.log("ds",e),new Error("invalid ds");if(!Ir(t))throw console.log("WOrm",t),new Error("invalid WOrm");if(!Mn(n))throw console.log("url",n),new Error("invalid url");if(!Mn(r))throw console.log("db",r),new Error("invalid db");let o={};return Gn(In(e),(e=>{let a=new t({url:n,db:r,cl:e});o[e]=a})),o}(e,t,n,r),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ir(e)?(Vf=e,Xf=It(t,"bCheckUser"),qr(Xf)||(Xf=!0),Zf=It(t,"getUserById"),Kf=It(t,"bExcludeWhenNotAdmin"),qr(Kf)||(Kf=!0),{addFunCheck:Qf,addFunPreProcessing:ep,addFunPostProcessing:tp,procOrm:np}):Promise.reject("invalid mapOrm")}(Gf(e,a),o);return op(op({},Cf),{},{woItems:a},i)}function ip(e){return e.indexOf("\\\\")>=0?"```"+e+"```":e}function sp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function up(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sp(Object(n),!0).forEach((function(t){$l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let cp={id:{pk:!0,name:"主鍵",type:"STRING"},order:{name:"順序",type:"INTEGER"},name:{name:"名稱",type:"STRING"},description:{name:"說明",type:"TEXT"},url:{name:"網址",type:"STRING"},method:{name:"方法",type:"STRING"},version:{name:"版本",type:"STRING"},group:{name:"群組",type:"STRING"},levels:{name:"階層群組",type:"STRING"},keywords:{name:"關鍵字",type:"STRING"},state:{name:"狀態",type:"STRING"},creator:{name:"創建者",type:"STRING"},dataSource:{name:"資料提供者",type:"STRING"},tokens:{name:"金鑰",type:"TEXT"},mdInputParams:{name:"輸入參數md說明",type:"STRING"},inputExample:{name:"輸入範例",type:"STRING"},mdOutputParams:{name:"輸出資料md說明",type:"STRING"},outputExample:{name:"輸出範例",type:"STRING"},timeCreate:{name:"創建時間",type:"STRING"},timeUpdate:{name:"更新時間",type:"STRING"},isActive:{name:"是否有效",type:"STRING"}},lp=function(){let e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!Vn(t))return{};let r={};return Gn(t,(function(t){r[t]=It(e,t,n)})),r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},In(cp));return e.id=`${Nl().format("YYYYMMDDHHmmss")}-${Tc()}`,e.timeCreate=Pf(),e.timeUpdate=e.timeCreate,e.isActive="y",e},fp={keyTable:"apis",tableNameCht:"APIs",tableNameEng:"APIs",settings:cp,funNew:lp,funTest:()=>{let e=wi([{id:"id-for-apis-sys-1",name:"取得API清單",description:"API管理中心取得API清單資訊",url:"http://localhost:11005/getAPIsList",method:"get",version:"v1",group:"全部",levels:"API",keywords:"API;center",state:"ok",creator:"apis-system",dataSource:"apis-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-1",name:"取得寵物清單",description:"寵物管理中心取得寵物清單資訊",url:"http://localhost:11005/getPetsList",method:"get",version:"v1",group:"寵物",levels:"寵物",keywords:"pets",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-dogs-1",name:"取得狗狗清單",description:"取得狗狗清單資訊",url:"http://localhost:11005/getDogsList",method:"get",version:"v1",group:"寵物",levels:"寵物.狗狗",keywords:"pets;dogs",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-dogs-2",name:"新增狗狗資訊",description:"新增狗狗資訊",url:"http://localhost:11005/addDog",method:"post",version:"v1",group:"寵物",levels:"寵物.狗狗",keywords:"pets;dogs",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### POST參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-dogs-3",name:"變更狗狗資訊",description:"變更狗狗資訊",url:"http://localhost:11005/updateDog",method:"put",version:"v1",group:"寵物",levels:"寵物.狗狗",keywords:"pets;dogs",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-dogs-4",name:"刪除狗狗資訊",description:"刪除狗狗資訊",url:"http://localhost:11005/deleteDog",method:"del",version:"v1",group:"寵物",levels:"寵物.狗狗",keywords:"pets;dogs",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-cats-1",name:"取得貓咪清單",description:"取得貓咪清單資訊",url:"http://localhost:11005/getCatsList",method:"get",version:"v1",group:"寵物",levels:"寵物.貓咪",keywords:"pets;cats",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-cats-2",name:"新增貓咪資訊",description:"新增貓咪資訊",url:"http://localhost:11005/addCat",method:"post",version:"v1",group:"寵物",levels:"寵物.貓咪",keywords:"pets;cats",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### POST參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-cats-3",name:"變更貓咪資訊",description:"變更貓咪資訊",url:"http://localhost:11005/updateCat",method:"put",version:"v1",group:"寵物",levels:"寵物.貓咪",keywords:"pets;cats",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-pets-cats-4",name:"刪除貓咪資訊",description:"刪除貓咪資訊",url:"http://localhost:11005/deleteCat",method:"del",version:"v1",group:"寵物",levels:"寵物.貓咪",keywords:"pets;cats",state:"ok",creator:"pets-system",dataSource:"pets-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-vehicles-cars-1",name:"取得汽車清單",description:"取得汽車清單資訊",url:"http://localhost:11005/getcarsList",method:"get",version:"v1",group:"寵物",levels:"交通工具.汽車",keywords:"vehicles;cars",state:"ok",creator:"vehicles-system",dataSource:"vehicles-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-vehicles-cars-2",name:"新增汽車資訊",description:"新增汽車資訊",url:"http://localhost:11005/addDog",method:"post",version:"v1",group:"寵物",levels:"交通工具.汽車",keywords:"vehicles;cars",state:"ok",creator:"vehicles-system",dataSource:"vehicles-data",mdInputParams:"### POST參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-vehicles-cars-3",name:"變更汽車資訊",description:"變更汽車資訊",url:"http://localhost:11005/updateDog",method:"put",version:"v1",group:"寵物",levels:"交通工具.汽車",keywords:"vehicles;cars",state:"ok",creator:"vehicles-system",dataSource:"vehicles-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '},{id:"id-for-apis-vehicles-cars-4",name:"刪除汽車資訊",description:"刪除汽車資訊",url:"http://localhost:11005/deleteDog",method:"del",version:"v1",group:"寵物",levels:"交通工具.汽車",keywords:"vehicles;cars",state:"ok",creator:"vehicles-system",dataSource:"vehicles-data",mdInputParams:"### GET網址參數\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| token | STRING | key-for-token |\n| id | STRING | id-for-test |\n| paramA | INTEGER | 123 |\n| paramB | DOUBLE | 123.456 |\n            ",inputExample:"http://localhost:11005/getAPIsList?token={token}&id={id}&paramA=123&paramB=123.456",mdOutputParams:`### 回傳數據欄位: Array of objects\n| 參數 | 型別 | 範例 |\n| -- | -- | -- |\n| id | STRING | id-for-test |\n| weight | DOUBLE | 12.3 |\n| color | STRING | #f26 |\n| paramA | INTEGER | 321 |\n| paramB | DOUBLE | 654.321 |\n| paramC | STRING | ${ip("C:\\\\pj\\abc\\filename.pdf")} |\n            `,outputExample:'\n[\n    {\n        "id": "id-for-test-1",\n        "weight": 12.3,\n        "color": "#f26",\n        "paramA": 101,\n        "paramB": 0.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename1.pdf"\n    },\n    {\n        "id": "id-for-test-2",\n        "weight": 22.3,\n        "color": "#2f6",\n        "paramA": 102,\n        "paramB": 1.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename2.pdf"\n    },\n    {\n        "id": "id-for-test-3",\n        "weight": 32.3,\n        "color": "#26f",\n        "paramA": 103,\n        "paramB": 2.01,\n        "paramC": "C:\\\\\\\\pj\\\\abc\\\\filename3.pdf"\n    }\n]\n            '}],((e,t)=>{let n=lp(up(up({},e),{},{order:t}));return n.id=e.id,Mn(e.timeUpdate)&&(n.timeUpdate=e.timeUpdate),n=function(e,t){if(!Fn(e))return{};if(!Vn(t))return{};let n={};return Gn(t,(function(t){Vu(e,t)&&(n[t]=It(e,t))})),n}(n,In(cp)),n}));return console.log("已產生: {keyTable} 測試資料",e),e}};function pp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pp(Object(n),!0).forEach((function(t){$l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hp(e){let t=It(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"useCreateStorage");qr(t)||(t=!1);let{keyTable:n,tableNameCht:r,tableNameEng:o,settings:a,parser:i,funNew:s,funTest:u,ext:c}=e;if(!Mn(n))throw new Error(`invalid keyTable[${n}]`);if(Mn(r)||(r=n),Mn(o)||(o=n),!Wn(a))throw new Error("invalid settings");Wn(c)||(c=null),Wn(i)||(i=null),Ir(s)||(s=null);let l=null;Ir(u)&&(l=async e=>{if(!Wn(e))throw new Error("invalid wo");if(!Vu(e,n))throw console.log(e),new Error(`keyTable[${n}] is not in wo`);let r=[];try{r=u(),Er(r)&&(r=await r)}catch(e){throw console.log(`keyTable[${n}] funTest catch`,e),new Error(e)}if(0!==Ju(r))return t&&await e[n].createStorage(),await e[n].save(r),r});let f={},p={};return Gn(In(a),(e=>{let t=It(a,`${e}.name`,"");Mn(t)&&(f[e]=t);let n=It(a,`${e}.type`,"");Mn(n)&&(p[e]=n)})),dp(dp({},e),{},{keyTable:n,tableNameCht:r,tableNameEng:o,settings:a,keys:In(a),kpType:p,kpHead:f,parser:i,funNew:s,funTest:u,funTestAndSave:l,ext:c})}let mp={apis:fp},vp={};for(let e in mp)vp[e]=hp(mp[e],{useCreateStorage:!1});return function(n,r,o,a,i,s){let u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c=null;if(!Ir(n))throw console.log("invalid WOrm",n),new Error("invalid WOrm");if(!Mn(r))throw console.log("invalid url",r),new Error("invalid url");if(!Mn(o))throw console.log("invalid db",o),new Error("invalid db");if(!Ir(a))throw console.log("invalid getUserByToken",a),new Error("invalid getUserByToken");if(!Ir(i))throw console.log("invalid verifyBrowserUser",i),new Error("invalid verifyBrowserUser");if(!Ir(s))throw console.log("invalid verifyAppUser",s),new Error("invalid verifyAppUser");let l=It(u,"serverPort");Tr(l)||(l=11005),l=Ar(l);let f=It(u,"bCheckUser",!1),p=It(u,"getUserById",null),d=It(u,"bExcludeWhenNotAdmin",!1),h=It(u,"webName",{}),m=It(u,"webDescription",{}),v=It(u,"webLogo",""),y=It(u,"subfolder","");var g,b;Mn(y)&&("/"===Br(y,1)&&(b=1,y=Mn(g=y)&&_r(b)?0===(b=Ar(b))?g:kr(g,g.length-b):""),"/"!==kr(y,1)&&(y=`/${y}`));let w=It(u,"urlRedirect",""),j={bCheckUser:f,getUserById:p,bExcludeWhenNotAdmin:d},O={};try{O=ap(vp,n,r,o,j)}catch(e){console.log(e)}let{woItems:S,procOrm:A}=O,T=e=>({webName:h,webDescription:m,webLogo:v}),I=async e=>{let t=a(e);return Er(t)&&(t=await t),Wn(t)?t:(console.log("token",e),console.log("can not find the user from token"),Promise.reject("can not find the user from token"))},E=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=await I(e),r=i(n,t);return Er(r)&&(r=await r),r?n:(console.log("userSelf",n),console.log("user does not have permission"),Promise.reject("user does not have permission"))},_=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await S.apis.select(e)},k=async e=>{let t=It(e,"payload");if(Mn(t)&&(t=Ln(t)),!Wn(t))return console.log("inp",t),console.log("invalid inp from req"),Promise.reject("invalid inp from req");let n=It(t,"group","");if(!Mn(n))return console.log("inp",t),console.log("group",n),console.log("invalid group from inp"),Promise.reject("invalid group from inp");let r=It(t,"apis",[]);return Vn(r)?(Gn(r,((e,t)=>{Gn(e,((e,n)=>{Mn(e)&&"base64:"===kr(e,7)&&(e=function(e,t){return Mn(e)&&_r(t)?0===(t=Ar(t))?e:Br(e,e.length-t):""}(e,7),e=Lr(e),r[t][n]=e)}))})),Gn(r,((e,t)=>{r[t].group=n})),t={group:n,apis:r},t):(console.log("inp",t),console.log("apis",r),console.log("invalid apis from inp"),Promise.reject("invalid apis from inp"))},B="dist",N="./node_modules/w-web-api/dist";var C;C=N,!t.existsSync(C)||t.lstatSync(C).isFile()||t.lstatSync(C).isSymbolicLink()||(B=N);let P="index.html";try{let n=e.resolve(B,"index.tmp");if(Fr(n)||(n=e.resolve(B,P)),!Fr(n))throw console.log("fpEntryIn",n),new Error("invalid fpEntryIn");let r=e.resolve(B,P),o=t.readFileSync(n,"utf8");o=Wr(o,"/mapi/","{sfd}/"),o=Wr(o,"{sfd}",y),o=Wr(o,"{urlRedirect}",w),t.writeFileSync(r,o,"utf8")}catch(e){console.log(e),console.log(`can not generate ${P}`)}let x=[{method:"GET",path:"/getWebInfor",handler:async function(e,t){return T()}},{method:"GET",path:"/api/getUserByToken",handler:async function(e,t){return await Cr((async function(){let t=It(e,"query.token",""),n=await E(t,"getUserByToken");return Wn(n)?n:(console.log("token",t),console.log("[API]getUserByToken/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission"))}))()}},{method:"GET",path:"/getAPIsList",handler:async function(e,t){return await Cr((async function(){let t=It(e,"query.token","");return Wn(await E(t,"getAPIsList"))?await _({isActive:"y"}):(console.log("token",t),console.log("[API]getAPIsList/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission"))}))()}},{method:"POST",path:"/updateAPIs",handler:async function(e,t){let n=await Cr((async function(){let t=It(e,"query.token","");if(!Wn(await E(t,"updateAPIs")))return console.log("token",t),console.log("[API]updateAPIs/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission");let n=await k(e),r=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{apis:t}=e;return await S.apis.save(t)}(n);return r}))();return n}},{method:"POST",path:"/syncAndReplaceApis",handler:async function(e,t){let n=await Cr((async function(){let t=It(e,"query.token",""),n=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=await I(e),r=s(n,t);return Er(r)&&(r=await r),r?n:(console.log("userSelf",n),console.log("user does not have permission"),Promise.reject("user does not have permission"))}(t,"syncAndReplaceApis");if(!Wn(n))return console.log("token",t),console.log("[API]syncAndReplaceApis/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission");let r=await k(e),o=await(async e=>{let t=It(e,"group","");if(!Mn(t))return console.log("params",e),console.log("group",t),console.log("invalid group"),Promise.reject("invalid group");let n=It(e,"apis",[]);return Vn(n)?(await S.apis.delAll({group:t}),await S.apis.insert(n)):(console.log("params",e),console.log("apis",n),console.log("invalid apis"),Promise.reject("invalid apis"))})(r);return o}))();return n}}],R=In(vp),D=R;return c=new Hl({port:u.serverPort,pathStaticFiles:B,apis:x,getUserIDFromToken:async e=>"",useDbORM:!0,dbORMs:S,operORM:A,tableNamesExec:R,methodsExec:["select","insert","save","del"],tableNamesSync:D,extFuncs:{getWebInfor:T,getAPIsList:function(e){return _(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}},hookBefores:null,hookAfters:null,fnTableTags:"tableTags-web-api.json"}),c}}));
//# sourceMappingURL=w-web-api.umd.js.map
